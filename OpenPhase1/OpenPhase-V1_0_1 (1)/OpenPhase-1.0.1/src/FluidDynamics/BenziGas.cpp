/*
 *   This file is part of the OpenPhase (R) software library.
 *
 *   Copyright (c) 2009-2022 Ruhr-Universitaet Bochum,
 *                 Universitaetsstrasse 150, D-44801 Bochum, Germany
 *             AND 2018-2022 OpenPhase Solutions GmbH,
 *                 Universitaetsstrasse 136, D-44799 Bochum, Germany.
 *
 *   This program is free software: you can redistribute it and/or modify
 *   it under the terms of the GNU General Public License as published by
 *   the Free Software Foundation, either version 3 of the License, or
 *   (at your option) any later version.
 *
 *   This program is distributed in the hope that it will be useful,
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *   GNU General Public License for more details.
 *
 *   You should have received a copy of the GNU General Public License
 *   along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 *   File created :   2019
 *   Main contributors :   Raphael Schiedung
 *
 */

#include <vector>
#include "FluidDynamics/BenziGas.h"

namespace openphase
{
namespace BenziGas
{
    EquilibriumValues_t EquilibriumValues(const double BenziParameter)
    {
        /// NOTE! The following reduced equilibrium values, Temperature,
        /// VaporDensity, and LiquidDensity, of the Van der Waals equation
        /// should not be changed! They may be updated by more accurate values
        /// or an analytical solution of the Van der Waals equation. They are
        /// used as input parameters of the FlowSolverLBM.
        const std::vector<EquilibriumValues_t> EquilibriumValues =
        {{-4.020E+00,5.77139E-01,8.22142E-01,1.10682E-04},
         {-4.030E+00,5.52793E-01,8.52968E-01,2.02944E-04},
         {-4.040E+00,5.32776E-01,8.79462E-01,3.11851E-04},
         {-4.050E+00,5.15511E-01,9.03195E-01,4.34988E-04},
         {-4.060E+00,5.00197E-01,9.24972E-01,5.70716E-04},
         {-4.070E+00,4.86361E-01,9.45262E-01,7.17811E-04},
         {-4.080E+00,4.73693E-01,9.64380E-01,8.75331E-04},
         {-4.090E+00,4.61979E-01,9.82534E-01,1.04250E-03},
         {-4.100E+00,4.51062E-01,9.99887E-01,1.21868E-03},
         {-4.110E+00,4.40824E-01,1.01655E+00,1.40332E-03},
         {-4.120E+00,4.31174E-01,1.03263E+00,1.59595E-03},
         {-4.130E+00,4.22039E-01,1.04818E+00,1.79617E-03},
         {-4.140E+00,4.13359E-01,1.06326E+00,2.00359E-03},
         {-4.150E+00,4.05087E-01,1.07794E+00,2.21789E-03},
         {-4.160E+00,3.97181E-01,1.09224E+00,2.43878E-03},
         {-4.170E+00,3.89607E-01,1.10621E+00,2.66598E-03},
         {-4.180E+00,3.82336E-01,1.11986E+00,2.89925E-03},
         {-4.190E+00,3.75342E-01,1.13323E+00,3.13835E-03},
         {-4.200E+00,3.68604E-01,1.14634E+00,3.38309E-03},
         {-4.210E+00,3.62101E-01,1.15921E+00,3.63326E-03},
         {-4.220E+00,3.55818E-01,1.17185E+00,3.88868E-03},
         {-4.230E+00,3.49739E-01,1.18428E+00,4.14918E-03},
         {-4.240E+00,3.43850E-01,1.19652E+00,4.41461E-03},
         {-4.250E+00,3.38140E-01,1.20857E+00,4.68481E-03},
         {-4.260E+00,3.32597E-01,1.22045E+00,4.95964E-03},
         {-4.270E+00,3.27211E-01,1.23216E+00,5.23898E-03},
         {-4.280E+00,3.21975E-01,1.24372E+00,5.52268E-03},
         {-4.290E+00,3.16879E-01,1.25513E+00,5.81064E-03},
         {-4.300E+00,3.11916E-01,1.26641E+00,6.10274E-03},
         {-4.310E+00,3.07079E-01,1.27755E+00,6.39887E-03},
         {-4.320E+00,3.02363E-01,1.28856E+00,6.69893E-03},
         {-4.330E+00,2.97760E-01,1.29946E+00,7.00282E-03},
         {-4.340E+00,2.93267E-01,1.31024E+00,7.31045E-03},
         {-4.350E+00,2.88877E-01,1.32092E+00,7.62172E-03},
         {-4.360E+00,2.84587E-01,1.33148E+00,7.93654E-03},
         {-4.370E+00,2.80392E-01,1.34195E+00,8.25485E-03},
         {-4.380E+00,2.76288E-01,1.35232E+00,8.57655E-03},
         {-4.390E+00,2.72272E-01,1.36260E+00,8.90157E-03},
         {-4.400E+00,2.68339E-01,1.37278E+00,9.22983E-03},
         {-4.410E+00,2.64487E-01,1.38289E+00,9.56127E-03},
         {-4.420E+00,2.60712E-01,1.39291E+00,9.89581E-03},
         {-4.430E+00,2.57012E-01,1.40284E+00,1.02334E-02},
         {-4.440E+00,2.53384E-01,1.41271E+00,1.05739E-02},
         {-4.450E+00,2.49825E-01,1.42249E+00,1.09174E-02},
         {-4.460E+00,2.46333E-01,1.43221E+00,1.12637E-02},
         {-4.470E+00,2.42906E-01,1.44186E+00,1.16129E-02},
         {-4.480E+00,2.39541E-01,1.45143E+00,1.19647E-02},
         {-4.490E+00,2.36236E-01,1.46095E+00,1.23192E-02},
         {-4.500E+00,2.32990E-01,1.47040E+00,1.26764E-02},
         {-4.510E+00,2.29801E-01,1.47978E+00,1.30362E-02},
         {-4.520E+00,2.26666E-01,1.48911E+00,1.33984E-02},
         {-4.530E+00,2.23585E-01,1.49838E+00,1.37632E-02},
         {-4.540E+00,2.20555E-01,1.50759E+00,1.41304E-02},
         {-4.550E+00,2.17575E-01,1.51675E+00,1.45000E-02},
         {-4.560E+00,2.14644E-01,1.52586E+00,1.48719E-02},
         {-4.570E+00,2.11760E-01,1.53491E+00,1.52461E-02},
         {-4.580E+00,2.08921E-01,1.54391E+00,1.56226E-02},
         {-4.590E+00,2.06128E-01,1.55286E+00,1.60013E-02},
         {-4.600E+00,2.03378E-01,1.56177E+00,1.63822E-02},
         {-4.610E+00,2.00670E-01,1.57063E+00,1.67652E-02},
         {-4.620E+00,1.98003E-01,1.57944E+00,1.71503E-02},
         {-4.630E+00,1.95376E-01,1.58821E+00,1.75375E-02},
         {-4.640E+00,1.92788E-01,1.59693E+00,1.79267E-02},
         {-4.650E+00,1.90239E-01,1.60561E+00,1.83179E-02},
         {-4.660E+00,1.87726E-01,1.61425E+00,1.87111E-02},
         {-4.670E+00,1.85250E-01,1.62285E+00,1.91061E-02},
         {-4.680E+00,1.82809E-01,1.63141E+00,1.95031E-02},
         {-4.690E+00,1.80402E-01,1.63993E+00,1.99019E-02},
         {-4.700E+00,1.78029E-01,1.64841E+00,2.03026E-02},
         {-4.710E+00,1.75689E-01,1.65685E+00,2.07050E-02},
         {-4.720E+00,1.73381E-01,1.66526E+00,2.11092E-02},
         {-4.730E+00,1.71104E-01,1.67363E+00,2.15151E-02},
         {-4.740E+00,1.68859E-01,1.68197E+00,2.19227E-02},
         {-4.750E+00,1.66643E-01,1.69028E+00,2.23320E-02},
         {-4.760E+00,1.64456E-01,1.69855E+00,2.27430E-02},
         {-4.770E+00,1.62298E-01,1.70678E+00,2.31555E-02},
         {-4.780E+00,1.60169E-01,1.71499E+00,2.35697E-02},
         {-4.790E+00,1.58066E-01,1.72316E+00,2.39854E-02},
         {-4.800E+00,1.55991E-01,1.73130E+00,2.44026E-02},
         {-4.810E+00,1.53942E-01,1.73941E+00,2.48214E-02},
         {-4.820E+00,1.51919E-01,1.74750E+00,2.52416E-02},
         {-4.830E+00,1.49922E-01,1.75555E+00,2.56634E-02},
         {-4.840E+00,1.47949E-01,1.76357E+00,2.60865E-02},
         {-4.850E+00,1.46000E-01,1.77157E+00,2.65111E-02},
         {-4.860E+00,1.44076E-01,1.77953E+00,2.69370E-02},
         {-4.870E+00,1.42174E-01,1.78747E+00,2.73643E-02},
         {-4.880E+00,1.40296E-01,1.79539E+00,2.77930E-02},
         {-4.890E+00,1.38440E-01,1.80327E+00,2.82230E-02},
         {-4.900E+00,1.36606E-01,1.81114E+00,2.86543E-02},
         {-4.910E+00,1.34794E-01,1.81897E+00,2.90868E-02},
         {-4.920E+00,1.33004E-01,1.82678E+00,2.95207E-02},
         {-4.930E+00,1.31234E-01,1.83457E+00,2.99557E-02},
         {-4.940E+00,1.29484E-01,1.84233E+00,3.03920E-02},
         {-4.950E+00,1.27755E-01,1.85007E+00,3.08295E-02},
         {-4.960E+00,1.26046E-01,1.85778E+00,3.12681E-02},
         {-4.970E+00,1.24356E-01,1.86547E+00,3.17079E-02},
         {-4.980E+00,1.22685E-01,1.87314E+00,3.21488E-02},
         {-4.990E+00,1.21033E-01,1.88079E+00,3.25909E-02},
         {-5.000E+00,1.19399E-01,1.88841E+00,3.30340E-02},
         {-5.010E+00,1.17783E-01,1.89601E+00,3.34783E-02},
         {-5.020E+00,1.16186E-01,1.90359E+00,3.39236E-02},
         {-5.030E+00,1.14606E-01,1.91115E+00,3.43699E-02},
         {-5.040E+00,1.13043E-01,1.91869E+00,3.48172E-02},
         {-5.050E+00,1.11497E-01,1.92621E+00,3.52656E-02},
         {-5.060E+00,1.09968E-01,1.93371E+00,3.57150E-02},
         {-5.070E+00,1.08455E-01,1.94119E+00,3.61653E-02},
         {-5.080E+00,1.06958E-01,1.94864E+00,3.66166E-02},
         {-5.090E+00,1.05477E-01,1.95608E+00,3.70688E-02},
         {-5.100E+00,1.04012E-01,1.96350E+00,3.75220E-02},
         {-5.110E+00,1.02563E-01,1.97091E+00,3.79760E-02},
         {-5.120E+00,1.01128E-01,1.97829E+00,3.84310E-02},
         {-5.130E+00,9.97085E-02,1.98565E+00,3.88868E-02},
         {-5.140E+00,9.83037E-02,1.99300E+00,3.93435E-02},
         {-5.150E+00,9.69133E-02,2.00033E+00,3.98010E-02},
         {-5.160E+00,9.55372E-02,2.00764E+00,4.02593E-02},
         {-5.170E+00,9.41752E-02,2.01494E+00,4.07185E-02},
         {-5.180E+00,9.28270E-02,2.02221E+00,4.11785E-02},
         {-5.190E+00,9.14924E-02,2.02947E+00,4.16393E-02},
         {-5.200E+00,9.01713E-02,2.03672E+00,4.21008E-02},
         {-5.210E+00,8.88635E-02,2.04394E+00,4.25631E-02},
         {-5.220E+00,8.75687E-02,2.05116E+00,4.30261E-02},
         {-5.230E+00,8.62868E-02,2.05835E+00,4.34899E-02},
         {-5.240E+00,8.50176E-02,2.06553E+00,4.39543E-02},
         {-5.250E+00,8.37609E-02,2.07269E+00,4.44195E-02},
         {-5.260E+00,8.25165E-02,2.07984E+00,4.48854E-02},
         {-5.270E+00,8.12844E-02,2.08698E+00,4.53519E-02},
         {-5.280E+00,8.00642E-02,2.09409E+00,4.58191E-02},
         {-5.290E+00,7.88558E-02,2.10120E+00,4.62870E-02},
         {-5.300E+00,7.76591E-02,2.10828E+00,4.67554E-02},
         {-5.310E+00,7.64740E-02,2.11536E+00,4.72246E-02},
         {-5.320E+00,7.53002E-02,2.12242E+00,4.76943E-02},
         {-5.330E+00,7.41376E-02,2.12946E+00,4.81646E-02},
         {-5.340E+00,7.29860E-02,2.13650E+00,4.86355E-02},
         {-5.350E+00,7.18454E-02,2.14351E+00,4.91070E-02},
         {-5.360E+00,7.07156E-02,2.15052E+00,4.95790E-02},
         {-5.370E+00,6.95964E-02,2.15751E+00,5.00516E-02},
         {-5.380E+00,6.84876E-02,2.16449E+00,5.05248E-02},
         {-5.390E+00,6.73893E-02,2.17145E+00,5.09984E-02},
         {-5.400E+00,6.63011E-02,2.17840E+00,5.14726E-02},
         {-5.410E+00,6.52231E-02,2.18534E+00,5.19473E-02},
         {-5.420E+00,6.41550E-02,2.19226E+00,5.24225E-02},
         {-5.430E+00,6.30968E-02,2.19918E+00,5.28982E-02},
         {-5.440E+00,6.20483E-02,2.20608E+00,5.33743E-02},
         {-5.450E+00,6.10094E-02,2.21296E+00,5.38509E-02},
         {-5.460E+00,5.99799E-02,2.21984E+00,5.43280E-02},
         {-5.470E+00,5.89599E-02,2.22670E+00,5.48054E-02},
         {-5.480E+00,5.79491E-02,2.23356E+00,5.52834E-02},
         {-5.490E+00,5.69474E-02,2.24040E+00,5.57617E-02},
         {-5.500E+00,5.59547E-02,2.24722E+00,5.62405E-02},
         {-5.510E+00,5.49710E-02,2.25404E+00,5.67196E-02},
         {-5.520E+00,5.39961E-02,2.26085E+00,5.71992E-02},
         {-5.530E+00,5.30299E-02,2.26764E+00,5.76791E-02},
         {-5.540E+00,5.20723E-02,2.27442E+00,5.81594E-02},
         {-5.550E+00,5.11232E-02,2.28119E+00,5.86401E-02},
         {-5.560E+00,5.01825E-02,2.28795E+00,5.91211E-02},
         {-5.570E+00,4.92501E-02,2.29470E+00,5.96024E-02},
         {-5.580E+00,4.83259E-02,2.30144E+00,6.00841E-02},
         {-5.590E+00,4.74099E-02,2.30817E+00,6.05662E-02},
         {-5.600E+00,4.65019E-02,2.31489E+00,6.10485E-02},
         {-5.610E+00,4.56018E-02,2.32160E+00,6.15311E-02},
         {-5.620E+00,4.47095E-02,2.32829E+00,6.20141E-02},
         {-5.630E+00,4.38250E-02,2.33498E+00,6.24973E-02},
         {-5.640E+00,4.29482E-02,2.34166E+00,6.29808E-02},
         {-5.650E+00,4.20790E-02,2.34832E+00,6.34646E-02},
         {-5.660E+00,4.12173E-02,2.35498E+00,6.39486E-02},
         {-5.670E+00,4.03629E-02,2.36163E+00,6.44329E-02},
         {-5.680E+00,3.95160E-02,2.36826E+00,6.49174E-02},
         {-5.690E+00,3.86762E-02,2.37489E+00,6.54022E-02},
         {-5.700E+00,3.78437E-02,2.38151E+00,6.58872E-02},
         {-5.710E+00,3.70182E-02,2.38812E+00,6.63724E-02},
         {-5.720E+00,3.61998E-02,2.39472E+00,6.68579E-02},
         {-5.730E+00,3.53884E-02,2.40131E+00,6.73435E-02},
         {-5.740E+00,3.45838E-02,2.40789E+00,6.78294E-02},
         {-5.750E+00,3.37860E-02,2.41446E+00,6.83154E-02},
         {-5.760E+00,3.29949E-02,2.42102E+00,6.88016E-02},
         {-5.770E+00,3.22105E-02,2.42757E+00,6.92880E-02},
         {-5.780E+00,3.14327E-02,2.43412E+00,6.97746E-02},
         {-5.790E+00,3.06614E-02,2.44066E+00,7.02613E-02},
         {-5.800E+00,2.98966E-02,2.44718E+00,7.07482E-02},
         {-5.810E+00,2.91382E-02,2.45370E+00,7.12352E-02},
         {-5.820E+00,2.83860E-02,2.46021E+00,7.17224E-02},
         {-5.830E+00,2.76402E-02,2.46671E+00,7.22097E-02},
         {-5.840E+00,2.69005E-02,2.47321E+00,7.26971E-02},
         {-5.850E+00,2.61670E-02,2.47969E+00,7.31846E-02},
         {-5.860E+00,2.54395E-02,2.48617E+00,7.36723E-02}};

        EquilibriumValues_t PreviousValue = EquilibriumValues[0];
        EquilibriumValues_t Interpolated  = {0.0,0.0,0.0,0.0};
        for (auto& Value: EquilibriumValues)
        {
            if (Value.BenziParameter == BenziParameter)
            {
                return Value;
            }
            else if (BenziParameter < Value.BenziParameter and
                     BenziParameter > PreviousValue.BenziParameter)
            {
                Interpolated = PreviousValue;

                const double dT = (Value.BenziParameter-PreviousValue.BenziParameter);
                const double DT = (BenziParameter-PreviousValue.BenziParameter);
                const double A  = DT/dT;

                Interpolated.BenziParameter     = BenziParameter;
                Interpolated.lbVaporDensity   += (Value.lbVaporDensity   - PreviousValue.lbVaporDensity)*A;
                Interpolated.lbLiquidDensity  += (Value.lbLiquidDensity  - PreviousValue.lbLiquidDensity)*A;
                Interpolated.lbSurfaceTension += (Value.lbSurfaceTension - PreviousValue.lbSurfaceTension)*A;

                return Interpolated;
            }
            PreviousValue = Value;
        }
        return Interpolated;
    }
} //namespase BenziGas
} //namespace openphase
